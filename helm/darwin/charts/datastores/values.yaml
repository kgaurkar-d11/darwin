# MySQL Database
mysql:
  enabled: true
  architecture: standalone
  auth:
    rootPassword: "{{ .Values.global.database.mysql.rootPassword }}"
    database: "{{ .Values.global.database.mysql.database }}"
    username: "{{ .Values.global.database.mysql.username }}"
    password: "{{ .Values.global.database.mysql.userPassword }}"
  primary:
    persistence:
      enabled: true
      size: 8Gi
    resources:
      limits:
        cpu: 1000m
        memory: 2Gi
      requests:
        cpu: 250m
        memory: 1Gi

# Cassandra Database
cassandra:
  enabled: false
  cluster:
    name: darwin-cassandra
    replicaCount: 1
  dbUser:
    user: "{{ .Values.global.database.cassandra.username }}"
    password: "{{ .Values.global.database.cassandra.password }}"
  persistence:
    enabled: true
    size: 2Gi
  resources:
    limits:
      cpu: 500m
      memory: 1.5Gi
    requests:
      cpu: 200m
      memory: 1Gi

# Apache Kafka
kafka:
  enabled: false
  image:
    repository: confluentinc/cp-kafka
    tag: "7.4.0"
  replicaCount: 1
  persistence:
    enabled: true
    size: 2Gi
  resources:
    limits:
      cpu: 500m
      memory: 1Gi
    requests:
      cpu: 200m
      memory: 512Mi

# Apache Zookeeper (for Helix)
zookeeper:
  enabled: false
  replicaCount: 1
  persistence:
    enabled: false
    size: 1Gi
  resources:
    limits:
      cpu: 300m
      memory: 512Mi
    requests:
      cpu: 150m
      memory: 256Mi

# Apache Airflow
airflow:
  enabled: true
  executor: CeleryExecutor
  image:
    repository: darwin-airflow
    tag: "latest"
    pullPolicy: Never
  webserver:
    replicas: 1
    defaultUser:
      enabled: true
      username: darwin
      password: darwin
      firstName: Darwin
      lastName: User
      email: admin@darwin.local
      role: Admin
    resources:
      limits:
        cpu: 1000m
        memory: 2Gi
      requests:
        cpu: 500m
        memory: 1Gi
  postgresql:
    enabled: false
  redis:
    enabled: false
  rabbitmq:
    enabled: true
    auth:
      username: airflow
      password: airflow
    persistence:
      enabled: true
      size: 1Gi
  mysql:
    enabled: false # Use existing MySQL service
  workers:
    replicas: 1
    resources:
      limits:
        cpu: 2000m
        memory: 4Gi
      requests:
        cpu: 500m
        memory: 2Gi
  scheduler:
    replicas: 1
    resources:
      limits:
        cpu: 500m
        memory: 2Gi
      requests:
        cpu: 200m
        memory: 1Gi
  dags:
    s3Folder: "s3://workflow-artifacts/workflow/airflow_artifacts/dags/"
    syncInterval: "1"  # seconds
  pools:
    # List of pools to create automatically during Airflow initialization
    # Format: pool_name: {slots: number, description: "string"}
    - name: "d11"
      slots: 128
      description: "Default tenant pool for Darwin workflows"

# LocalStack (S3 Mock)
localstack:
  enabled: true
  image:
    repository: localstack/localstack
    tag: "latest"
    pullPolicy: IfNotPresent
  persistence:
    enabled: true
    size: 2Gi
  services: "s3,sqs"
  resources:
    limits:
      cpu: 1000m
      memory: 1Gi
    requests:
      cpu: 250m
      memory: 512Mi
  env:
    awsEndpointOverride: "http://{{ $.Release.Name }}-localstack:4566"

# OpenSearch (Elasticsearch-compatible) - Shared datastore
opensearch:
  enabled: true
  clusterName: darwin-opensearch
  replicaCount: 1  # Single node for local development
  auth:
    username: "{{ .Values.global.database.elasticsearch.username }}"
    password: "{{ .Values.global.database.elasticsearch.password }}"
  persistence:
    enabled: true
    size: 2Gi
  resources:
    limits:
      cpu: 500m
      memory: 1Gi
    requests:
      cpu: 200m
      memory: 512Mi
  env:
    DISABLE_SECURITY_PLUGIN: "true"
    discovery.type: "single-node"

# Elasticsearch (for Workflow service - separate from OpenSearch)
elasticsearch:
  enabled: true
  tag: "8.6.2"
  replicaCount: 1  # Single node for local development
  javaOpts:
    heap: "512m"
  persistence:
    enabled: true
    size: 2Gi
  resources:
    limits:
      cpu: 500m
      memory: 1Gi
    requests:
      cpu: 200m
      memory: 512Mi
